package ui

import (
"strconv"
"donegeon/internal/config"
)

templ Board(boardConfig config.BoardUIConfig) {
	<div class="grid h-full w-full grid-rows-[48px_1fr]">
		<!-- Header with loot inventory -->
		<header class="flex items-center justify-between border-b border-border bg-card/80 px-3 backdrop-blur">
			<div class="flex items-center gap-3">
				<!-- Mobile hamburger menu -->
				<button
					id="goalsMenuToggle"
					class="rounded-md border border-border bg-card px-2 py-1.5 hover:bg-accent md:hidden"
					type="button"
					aria-label="Toggle goals menu"
				>
					<svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
					</svg>
				</button>
				<div class="text-sm font-bold tracking-wide">DONEGEON</div>
			</div>

			<!-- Loot inventory -->
			<div id="lootInventory" class="flex items-center gap-3 text-sm">
				<div class="flex items-center gap-1" title="Coins">
					<span>ğŸª™</span>
					<span id="loot-coin" class="font-semibold">0</span>
				</div>
				<div class="flex items-center gap-1" title="Paper">
					<span>ğŸ“„</span>
					<span id="loot-paper" class="font-semibold">0</span>
				</div>
				<div class="flex items-center gap-1" title="Ink">
					<span>ğŸ–‹ï¸</span>
					<span id="loot-ink" class="font-semibold">0</span>
				</div>
				<div class="flex items-center gap-1" title="Gear">
					<span>âš™ï¸</span>
					<span id="loot-gear" class="font-semibold">0</span>
				</div>
				<div class="flex items-center gap-1" title="Parts">
					<span>ğŸ”©</span>
					<span id="loot-parts" class="font-semibold">0</span>
				</div>
				<div class="flex items-center gap-1" title="Blueprint Shards">
					<span>ğŸ§©</span>
					<span id="loot-blueprint_shard" class="font-semibold">0</span>
				</div>
			</div>

			<!-- Action buttons -->
			<div class="flex items-center gap-2">
				<button id="endDayBtn" type="button" class="rounded-md border border-red-500/50 bg-red-500/10 px-3 py-1 text-xs font-medium text-red-400 hover:bg-red-500/20">
					End Day
				</button>
				<button id="boardRefreshBtn" type="button" class="rounded-md border border-border bg-card px-3 py-1 text-xs hover:bg-accent">
					Refresh
				</button>
				<button type="button" class="rounded-md border border-border bg-card px-2 py-1 text-xs hover:bg-accent">
					?
				</button>
			</div>
		</header>

		<div id="appShell" class="flex h-full w-full min-w-0 overflow-hidden">
			<!-- Today's Goals sidebar (desktop only - hidden on mobile) -->
			<aside id="goalsSidebarDesktop" class="w-[280px] shrink-0 h-full border-r border-border bg-zinc-900/95 overflow-y-auto max-md:hidden">
				@TodaysGoalsSidebar()
			</aside>

			<!-- Mobile goals drawer (fixed overlay) -->
			<aside
				id="goalsSidebarMobile"
				class="
					fixed inset-y-0 left-0 z-50 w-[280px]
					-translate-x-full transition-transform duration-200
					border-r border-border bg-zinc-900/95 backdrop-blur
					overflow-y-auto flex flex-col
					md:hidden
				"
			>
				@TodaysGoalsSidebarContent()
			</aside>

			<!-- Mobile goals drawer backdrop -->
			<div
				id="goalsBackdrop"
				class="fixed inset-0 z-40 hidden bg-black/50 md:hidden"
			></div>

			<!-- Main board area -->
			<main class="relative flex-1 h-full min-w-0 overflow-hidden">
				<div id="boardRoot" class="relative h-full w-full min-w-0 dotted-field"
					style={
						" --ui-grid:" + strconv.Itoa(boardConfig.GridSize) + "px;" +
						" --ui-card-w:" + strconv.Itoa(boardConfig.CardWidth) + "px;" +
						" --ui-card-h:" + strconv.Itoa(boardConfig.CardHeight) + "px;" +
						" --ui-stack-off-y:" + strconv.Itoa(boardConfig.StackOffsetY) + "px;"
					}
				>
					<div id="board" class="absolute inset-0 pb-[160px]"></div>

					<!-- Bottom deck row -->
					<div id="deckRow" class="absolute bottom-0 left-0 right-0 flex items-end justify-center gap-2 bg-gradient-to-t from-black/30 to-transparent px-4 py-3">
						<!-- Decks will be rendered here by JS -->
					</div>
				</div>
			</main>
		</div>
	</div>
	@TaskModalShell()
	@SLCard()

}
